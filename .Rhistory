theme(legend.key = element_rect(fill = "transparent", color=NA))+
theme (plot.background =  element_rect(fill = "transparent", color=NA),
panel.background = element_rect(fill = "transparent", color=NA),)+
theme(panel.border = element_rect(linetype = "solid", colour = "black", size = 2))+
theme(plot.title = element_text(hjust = 0.5), plot.subtitle = element_text(hjust = 0.5) )
ggplot
knitr::opts_chunk$set(echo = TRUE)
library("reshape2")
library(dplyr)
library(ggplot2)
library(tidyverse)
library(rmarkdown)
library(cowplot)
library(yaml)
library(knitr)
rawdata <- read.csv("../Input/20230406_RPMI_Atmut_screen_Plate3_csv.csv")
rawdata_day<-mutate(rawdata, Time = Time/86400)
reshaped <- melt(rawdata_day, id=c("Time", "Temp"),
variable.name="Well",
value.name="OD595")
summary(reshaped)
platemap <- read.csv("../Input/20230406_RPMI_Atmut_screen_Plate3_setup.csv")
head(platemap, n=50)
annotated <- inner_join(reshaped, platemap, by="Well")
ggplot(data=filter(annotated,Strain==""),
aes(x=Time, y=OD595, color=Strain, group = Well)) +
geom_line() +
facet_grid(Media ~ .) +
labs(x="Time (days)", y="Absorbance at 595 nm")
ggplot(data=filter(annotated,Well=="A1"),
aes(x=Time, y=OD595, color=Strain, group = Well)) +
geom_line() +
theme_bw()+
labs(x="Time (hrs)", y="Absorbance at 595 nm")
blank_OD_summary <- annotated %>%
filter(Strain=="") %>%
filter(Well != "A1") %>%
group_by(Media) %>%
summarise(OD_median=median(OD595),
OD_mean=mean(OD595),
OD_max=max(OD595),
OD_min=min(OD595))
print(blank_OD_summary)
normalisedOD <- annotated %>%
left_join(blank_OD_summary, by="Media") %>%
mutate(OD_corrected = OD595 - OD_median)
ggplot(data=normalisedOD %>%
filter(Strain != ""),
aes(x=Time, y=OD_corrected, color=Strain, group = Well)) +
geom_line() +
scale_y_continuous(limits=c(0,0.05),expand=c(0,0))+
facet_wrap(Strain ~ .)+
labs(x = "Time(Hrs)",
y = "Absorbance (595nm)") +
theme(text = element_text(size = 20))+
theme_bw()
ggplot(data=normalisedOD %>%
dplyr::mutate(Strain = factor(Strain, levels = c("KN99 (WT)", "GAT201", "P2.7A10","P2.7A11","P2.7A12","P2.7B1","P2.7B2","P2.7B3","P2.7B4","P2.7B5","P2.7B6","P2.28A10","P2.28A11","P2.28A12","P2.28B1","P2.28B2","P2.28B3","P2.28B4","P2.28B5","P2.28B6" )))%>%
filter(Strain != ""),
aes(x=Time, y=OD_corrected, color=Strain)) +
stat_summary(fun = "median", geom = "line", size = 0.5) +
#scale_y_continuous(limits=c(0,0.5),expand=c(0,0), breaks = c(0, 0.05, 0.1)) +
labs(x = "Number of Days",
y = "Absorbance (595nm)",
title = "At mutant screen", subtitle = "Plate 3: RPMI at 37 degrees") +
theme_bw() +
theme(text = element_text(size = 15))+
theme(axis.title = element_text(size = 15))+
theme(axis.ticks.length = unit(0.3, "cm"))+
theme(title = element_text(size = 15))+
theme(panel.grid.minor = element_blank())+
guides(color=guide_legend(ncol=2))+
theme(legend.title = element_text(size = 15))+
theme(legend.background = element_rect(fill = "transparent", color=NA))+
theme(legend.key = element_rect(fill = "transparent", color=NA))+
theme (plot.background =  element_rect(fill = "transparent", color=NA),
panel.background = element_rect(fill = "transparent", color=NA),)+
theme(panel.border = element_rect(linetype = "solid", colour = "black", size = 2))+
theme(plot.title = element_text(hjust = 0.5), plot.subtitle = element_text(hjust = 0.5) )
ggplot
ggsave("../Results/AllSummary_At3.png",width = 8,height=5)
ggplot(data=normalisedOD %>%
dplyr::mutate(Strain = factor(Strain, levels = c("KN99 (WT)", "GAT201", "P2.7A10","P2.7A11","P2.7A12","P2.7B1","P2.7B2","P2.7B3","P2.7B4","P2.7B5","P2.7B6","P2.28A11","P2.28A11","P2.28A12","P2.28B1","P2.28B2","P2.28B3","P2.28B4","P2.28B5","P2.28B6" )))%>%
filter(Strain != ""),
aes(x=Time, y=OD_corrected, color=Strain)) +
geom_line(aes(group = Well), size = 0.2, alpha = 0.2) +
stat_summary(fun = "median", geom = "line", size = 1) +
#scale_y_continuous(limits=c(0,0.5),expand=c(0,0), breaks = c(0, 0.05, 0.1)) +
labs(x = "Number of Days",
y = "Absorbance (595nm)",
title = "GAT201 Targets", subtitle = "Plate 2: RPMI at 37 degrees") +
theme_bw() +
theme(text = element_text(size = 15))+
theme(axis.title = element_text(size = 15))+
theme(axis.ticks.length = unit(0.3, "cm"))+
theme(title = element_text(size = 15))+
theme(panel.grid.minor = element_blank())+
guides(color=guide_legend(ncol=2))+
theme(legend.title = element_text(size = 15))+
theme(legend.background = element_rect(fill = "transparent", color=NA))+
theme(legend.key = element_rect(fill = "transparent", color=NA))+
theme (plot.background =  element_rect(fill = "transparent", color=NA),
panel.background = element_rect(fill = "transparent", color=NA),)+
theme(panel.border = element_rect(linetype = "solid", colour = "black", size = 1))+
theme(plot.title = element_text(hjust = 0.5), plot.subtitle = element_text(hjust = 0.5))
ggplot(data=normalisedOD %>%
dplyr::mutate(Strain = factor(Strain, levels = c("KN99 (WT)", "GAT201", "P2.7A10","P2.7A11","P2.7A12","P2.7B1","P2.7B2","P2.7B3","P2.7B4","P2.7B5","P2.7B6","P2.28A11","P2.28A11","P2.28A12","P2.28B1","P2.28B2","P2.28B3","P2.28B4","P2.28B5","P2.28B6" ))%>%
filter(Strain != ""),
aes(x=Time, y=OD_corrected, color=Strain)) +
geom_line(aes(group = Well), size = 0.2, alpha = 0.2) +
stat_summary(fun = "median", geom = "line", size = 1) +
#scale_y_continuous(limits=c(0,0.5),expand=c(0,0), breaks = c(0, 0.05, 0.1)) +
labs(x = "Number of Days",
y = "Absorbance (595nm)",
title = "GAT201 Targets", subtitle = "Plate 3: RPMI at 37 degrees") +
theme_bw() +
theme(text = element_text(size = 15))+
theme(axis.title = element_text(size = 15))+
theme(axis.ticks.length = unit(0.3, "cm"))+
theme(title = element_text(size = 15))+
theme(panel.grid.minor = element_blank())+
guides(color=guide_legend(ncol=2))+
theme(legend.title = element_text(size = 15))+
theme(legend.background = element_rect(fill = "transparent", color=NA))+
theme(legend.key = element_rect(fill = "transparent", color=NA))+
theme (plot.background =  element_rect(fill = "transparent", color=NA),
panel.background = element_rect(fill = "transparent", color=NA),)+
theme(panel.border = element_rect(linetype = "solid", colour = "black", size = 1))+
theme(plot.title = element_text(hjust = 0.5), plot.subtitle = element_text(hjust = 0.5))
ggplot(data=normalisedOD %>%
dplyr::mutate(Strain = factor(Strain, levels = c("KN99 (WT)", "GAT201", "P2.7A10","P2.7A11","P2.7A12","P2.7B1","P2.7B2","P2.7B3","P2.7B4","P2.7B5","P2.7B6","P2.28A11","P2.28A11","P2.28A12","P2.28B1","P2.28B2","P2.28B3","P2.28B4","P2.28B5","P2.28B6" )))%>%
filter(Strain != ""),
aes(x=Time, y=OD_corrected, color=Strain)) +
geom_line(aes(group = Well), size = 0.2, alpha = 0.2) +
stat_summary(fun = "median", geom = "line", size = 1) +
#scale_y_continuous(limits=c(0,0.5),expand=c(0,0), breaks = c(0, 0.05, 0.1)) +
labs(x = "Number of Days",
y = "Absorbance (595nm)",
title = "GAT201 Targets", subtitle = "Plate 3: RPMI at 37 degrees") +
theme_bw() +
theme(text = element_text(size = 15))+
theme(axis.title = element_text(size = 15))+
theme(axis.ticks.length = unit(0.3, "cm"))+
theme(title = element_text(size = 15))+
theme(panel.grid.minor = element_blank())+
guides(color=guide_legend(ncol=2))+
theme(legend.title = element_text(size = 15))+
theme(legend.background = element_rect(fill = "transparent", color=NA))+
theme(legend.key = element_rect(fill = "transparent", color=NA))+
theme (plot.background =  element_rect(fill = "transparent", color=NA),
panel.background = element_rect(fill = "transparent", color=NA),)+
theme(panel.border = element_rect(linetype = "solid", colour = "black", size = 1))+
theme(plot.title = element_text(hjust = 0.5), plot.subtitle = element_text(hjust = 0.5))
ggplot(data=normalisedOD %>%
dplyr::mutate(Strain = factor(Strain, levels = c("KN99 (WT)", "GAT201", "P2.7A10","P2.7A11","P2.7A12","P2.7B1","P2.7B2","P2.7B3","P2.7B4","P2.7B5","P2.7B6","P2.28A11","P2.28A11","P2.28A12","P2.28B1","P2.28B2","P2.28B3","P2.28B4","P2.28B5","P2.28B6" )))%>%
filter(Strain != ""),
aes(x=Time, y=OD_corrected, color=Strain)) +
geom_line(aes(group = Well), size = 0.2, alpha = 0.2) +
stat_summary(fun = "median", geom = "line", size = 1) +
#scale_y_continuous(limits=c(0,0.5),expand=c(0,0), breaks = c(0, 0.05, 0.1)) +
labs(x = "Number of Days",
y = "Absorbance (595nm)",
title = "At mutant screen", subtitle = "Plate 3: RPMI at 37 degrees") +
theme_bw() +
theme(text = element_text(size = 15))+
theme(axis.title = element_text(size = 15))+
theme(axis.ticks.length = unit(0.3, "cm"))+
theme(title = element_text(size = 15))+
theme(panel.grid.minor = element_blank())+
guides(color=guide_legend(ncol=2))+
theme(legend.title = element_text(size = 15))+
theme(legend.background = element_rect(fill = "transparent", color=NA))+
theme(legend.key = element_rect(fill = "transparent", color=NA))+
theme (plot.background =  element_rect(fill = "transparent", color=NA),
panel.background = element_rect(fill = "transparent", color=NA),)+
theme(panel.border = element_rect(linetype = "solid", colour = "black", size = 2))+
theme(plot.title = element_text(hjust = 0.5), plot.subtitle = element_text(hjust = 0.5) )
ggplot(data=normalisedOD %>%
dplyr::mutate(Strain = factor(Strain, levels = c("KN99 (WT)", "GAT201", "P2.7A10","P2.7A11","P2.7A12","P2.7B1","P2.7B2","P2.7B3","P2.7B4","P2.7B5","P2.7B6","P2.28A10","P2.28A11","P2.28A12","P2.28B1","P2.28B2","P2.28B3","P2.28B4","P2.28B5","P2.28B6" )))%>%
filter(Strain != ""),
aes(x=Time, y=OD_corrected, color=Strain)) +
geom_line(aes(group = Well), size = 0.2, alpha = 0.2) +
stat_summary(fun = "median", geom = "line", size = 0.5) +
#scale_y_continuous(limits=c(0,0.5),expand=c(0,0), breaks = c(0, 0.05, 0.1)) +
labs(x = "Number of Days",
y = "Absorbance (595nm)",
title = "At mutant screen", subtitle = "Plate 3: RPMI at 37 degrees") +
theme_bw() +
theme(text = element_text(size = 15))+
theme(axis.title = element_text(size = 15))+
theme(axis.ticks.length = unit(0.3, "cm"))+
theme(title = element_text(size = 15))+
theme(panel.grid.minor = element_blank())+
guides(color=guide_legend(ncol=2))+
theme(legend.title = element_text(size = 15))+
theme(legend.background = element_rect(fill = "transparent", color=NA))+
theme(legend.key = element_rect(fill = "transparent", color=NA))+
theme (plot.background =  element_rect(fill = "transparent", color=NA),
panel.background = element_rect(fill = "transparent", color=NA),)+
theme(panel.border = element_rect(linetype = "solid", colour = "black", size = 2))+
theme(plot.title = element_text(hjust = 0.5), plot.subtitle = element_text(hjust = 0.5) )
ggsave("../Results/Statsumm_At3.png",width = 8,height=5)
knitr::opts_chunk$set(echo = TRUE)
library("reshape2")
library(dplyr)
library(ggplot2)
library(tidyverse)
library(rmarkdown)
library(cowplot)
library(yaml)
library(knitr)
rawdata <- read.csv("../Input/20230407_RPMI_Atmut_screen_Plate4_csv.csv")
rawdata_day<-mutate(rawdata, Time = Time/86400)
reshaped <- melt(rawdata_day, id=c("Time", "Temp"),
variable.name="Well",
value.name="OD595")
summary(reshaped)
platemap <- read.csv("../Input/20230407_RPMI_Atmut_screen_Plate4_setup.csv")
head(platemap, n=50)
annotated <- inner_join(reshaped, platemap, by="Well")
ggplot(data=filter(annotated,Strain==""),
aes(x=Time, y=OD595, color=Strain, group = Well)) +
geom_line() +
facet_grid(Media ~ .) +
labs(x="Time (days)", y="Absorbance at 595 nm")
ggplot(data=filter(annotated,Well=="G12"),
aes(x=Time, y=OD595, color=Strain, group = Well)) +
geom_line() +
theme_bw()+
labs(x="Time (hrs)", y="Absorbance at 595 nm")
blank_OD_summary <- annotated %>%
filter(Strain=="") %>%
filter(Well != "A6") %>%
filter(Well != "A12") %>%
filter(Well != "H3") %>%
filter(Well != "F1") %>%
group_by(Media) %>%
summarise(OD_median=median(OD595),
OD_mean=mean(OD595),
OD_max=max(OD595),
OD_min=min(OD595))
print(blank_OD_summary)
normalisedOD <- annotated %>%
left_join(blank_OD_summary, by="Media") %>%
mutate(OD_corrected = OD595 - OD_median)
ggplot(data=normalisedOD %>%
filter(Strain != ""),
aes(x=Time, y=OD_corrected, color=Strain, group = Well)) +
geom_line() +
scale_y_continuous(limits=c(0,0.025),expand=c(0,0))+
facet_wrap(Strain ~ .)+
labs(x = "Time(Hrs)",
y = "Absorbance (595nm)") +
theme(text = element_text(size = 20))+
theme_bw()
ggplot(data=normalisedOD %>%
dplyr::mutate(Strain = factor(Strain, levels = c("P2.7B7","P2.7B8","P2.7B9","P2.7B10","P2.7B11","P2.7B12","P2.7C1","P2.7C2","P2.7C3","P2.7C4","P2.28B7","P2.28B8","P2.28B9","P2.28B10","P2.28B11","P2.28B12","P2.28C1","P2.28C2","P2.28C3","P2.28C4" )))%>%
filter(Strain != ""),
aes(x=Time, y=OD_corrected, color=Strain)) +
stat_summary(fun = "median", geom = "line", size = 0.5) +
#scale_y_continuous(limits=c(0,0.5),expand=c(0,0), breaks = c(0, 0.05, 0.1)) +
labs(x = "Number of Days",
y = "Absorbance (595nm)",
title = "At mutant screen", subtitle = "Plate 4: RPMI at 37 degrees") +
theme_bw() +
theme(text = element_text(size = 15))+
theme(axis.title = element_text(size = 15))+
theme(axis.ticks.length = unit(0.3, "cm"))+
theme(title = element_text(size = 15))+
theme(panel.grid.minor = element_blank())+
guides(color=guide_legend(ncol=2))+
theme(legend.title = element_text(size = 15))+
theme(legend.background = element_rect(fill = "transparent", color=NA))+
theme(legend.key = element_rect(fill = "transparent", color=NA))+
theme (plot.background =  element_rect(fill = "transparent", color=NA),
panel.background = element_rect(fill = "transparent", color=NA),)+
theme(panel.border = element_rect(linetype = "solid", colour = "black", size = 2))+
theme(plot.title = element_text(hjust = 0.5), plot.subtitle = element_text(hjust = 0.5) )
ggplot
ggsave("../Results/AllSummary_At4.png",width = 6.6,height=5)
ggplot(data=normalisedOD %>%
dplyr::mutate(Strain = factor(Strain, levels = c("P2.7B7","P2.7B8","P2.7B9","P2.7B10","P2.7B11","P2.7B12","P2.7C1","P2.7C2","P2.7C3","P2.7C4","P2.28B7","P2.28B8","P2.28B9","P2.28B10","P2.28B11","P2.28B12","P2.28C1","P2.28C2","P2.28C3","P2.28C4" )))%>%
filter(Strain != ""),
aes(x=Time, y=OD_corrected, color=Strain)) +
geom_line(aes(group = Well), size = 0.2, alpha = 0.2) +
stat_summary(fun = "median", geom = "line", size = 1) +
#scale_y_continuous(limits=c(0,0.5),expand=c(0,0), breaks = c(0, 0.05, 0.1)) +
labs(x = "Number of Days",
y = "Absorbance (595nm)",
title = "At mutant screen", subtitle = "Plate 3: RPMI at 37 degrees") +
theme_bw() +
theme(text = element_text(size = 15))+
theme(axis.title = element_text(size = 15))+
theme(axis.ticks.length = unit(0.3, "cm"))+
theme(title = element_text(size = 15))+
theme(panel.grid.minor = element_blank())+
guides(color=guide_legend(ncol=2))+
theme(legend.title = element_text(size = 15))+
theme(legend.background = element_rect(fill = "transparent", color=NA))+
theme(legend.key = element_rect(fill = "transparent", color=NA))+
theme (plot.background =  element_rect(fill = "transparent", color=NA),
panel.background = element_rect(fill = "transparent", color=NA),)+
theme(panel.border = element_rect(linetype = "solid", colour = "black", size = 2))+
theme(plot.title = element_text(hjust = 0.5), plot.subtitle = element_text(hjust = 0.5) )
ggsave("../Results/Statsumm_At4.png",width = 6.6,height=5)
knitr::opts_chunk$set(echo = TRUE)
library("reshape2")
library(dplyr)
library(ggplot2)
library(tidyverse)
library(rmarkdown)
library(cowplot)
library(yaml)
library(knitr)
rawdata <- read.csv("../Input/20230407_RPMI_Atmut_screen_Plate4_csv.csv")
rawdata_day<-mutate(rawdata, Time = Time/86400)
reshaped <- melt(rawdata_day, id=c("Time", "Temp"),
variable.name="Well",
value.name="OD595")
summary(reshaped)
platemap <- read.csv("../Input/20230407_RPMI_Atmut_screen_Plate4_setup.csv")
head(platemap, n=50)
annotated <- inner_join(reshaped, platemap, by="Well")
ggplot(data=filter(annotated,Strain==""),
aes(x=Time, y=OD595, color=Strain, group = Well)) +
geom_line() +
facet_grid(Media ~ .) +
labs(x="Time (days)", y="Absorbance at 595 nm")
ggplot(data=filter(annotated,Well=="G12"),
aes(x=Time, y=OD595, color=Strain, group = Well)) +
geom_line() +
theme_bw()+
labs(x="Time (hrs)", y="Absorbance at 595 nm")
blank_OD_summary <- annotated %>%
filter(Strain=="") %>%
filter(Well != "A6") %>%
filter(Well != "A12") %>%
filter(Well != "H3") %>%
filter(Well != "F1") %>%
group_by(Media) %>%
summarise(OD_median=median(OD595),
OD_mean=mean(OD595),
OD_max=max(OD595),
OD_min=min(OD595))
print(blank_OD_summary)
normalisedOD <- annotated %>%
left_join(blank_OD_summary, by="Media") %>%
mutate(OD_corrected = OD595 - OD_median)
ggplot(data=normalisedOD %>%
filter(Strain != ""),
aes(x=Time, y=OD_corrected, color=Strain, group = Well)) +
geom_line() +
scale_y_continuous(limits=c(0,0.025),expand=c(0,0))+
facet_wrap(Strain ~ .)+
labs(x = "Time(Hrs)",
y = "Absorbance (595nm)") +
theme(text = element_text(size = 20))+
theme_bw()
ggplot(data=normalisedOD %>%
dplyr::mutate(Strain = factor(Strain, levels = c("P2.7B7","P2.7B8","P2.7B9","P2.7B10","P2.7B11","P2.7B12","P2.7C1","P2.7C2","P2.7C3","P2.7C4","P2.28B7","P2.28B8","P2.28B9","P2.28B10","P2.28B11","P2.28B12","P2.28C1","P2.28C2","P2.28C3","P2.28C4" )))%>%
filter(Strain != ""),
aes(x=Time, y=OD_corrected, color=Strain)) +
stat_summary(fun = "median", geom = "line", size = 0.5) +
#scale_y_continuous(limits=c(0,0.5),expand=c(0,0), breaks = c(0, 0.05, 0.1)) +
labs(x = "Number of Days",
y = "Absorbance (595nm)",
title = "At mutant screen", subtitle = "Plate 4: RPMI at 37 degrees") +
theme_bw() +
theme(text = element_text(size = 15))+
theme(axis.title = element_text(size = 15))+
theme(axis.ticks.length = unit(0.3, "cm"))+
theme(title = element_text(size = 15))+
theme(panel.grid.minor = element_blank())+
guides(color=guide_legend(ncol=2))+
theme(legend.title = element_text(size = 15))+
theme(legend.background = element_rect(fill = "transparent", color=NA))+
theme(legend.key = element_rect(fill = "transparent", color=NA))+
theme (plot.background =  element_rect(fill = "transparent", color=NA),
panel.background = element_rect(fill = "transparent", color=NA),)+
theme(panel.border = element_rect(linetype = "solid", colour = "black", size = 2))+
theme(plot.title = element_text(hjust = 0.5), plot.subtitle = element_text(hjust = 0.5) )
ggplot
ggsave("../Results/AllSummary_At4.png",width = 6.6,height=5)
ggplot(data=normalisedOD %>%
dplyr::mutate(Strain = factor(Strain, levels = c("P2.7B7","P2.7B8","P2.7B9","P2.7B10","P2.7B11","P2.7B12","P2.7C1","P2.7C2","P2.7C3","P2.7C4","P2.28B7","P2.28B8","P2.28B9","P2.28B10","P2.28B11","P2.28B12","P2.28C1","P2.28C2","P2.28C3","P2.28C4" )))%>%
filter(Strain != ""),
aes(x=Time, y=OD_corrected, color=Strain)) +
geom_line(aes(group = Well), size = 0.2, alpha = 0.2) +
stat_summary(fun = "median", geom = "line", size = 0.5) +
#scale_y_continuous(limits=c(0,0.5),expand=c(0,0), breaks = c(0, 0.05, 0.1)) +
labs(x = "Number of Days",
y = "Absorbance (595nm)",
title = "At mutant screen", subtitle = "Plate 3: RPMI at 37 degrees") +
theme_bw() +
theme(text = element_text(size = 15))+
theme(axis.title = element_text(size = 15))+
theme(axis.ticks.length = unit(0.3, "cm"))+
theme(title = element_text(size = 15))+
theme(panel.grid.minor = element_blank())+
guides(color=guide_legend(ncol=2))+
theme(legend.title = element_text(size = 15))+
theme(legend.background = element_rect(fill = "transparent", color=NA))+
theme(legend.key = element_rect(fill = "transparent", color=NA))+
theme (plot.background =  element_rect(fill = "transparent", color=NA),
panel.background = element_rect(fill = "transparent", color=NA),)+
theme(panel.border = element_rect(linetype = "solid", colour = "black", size = 2))+
theme(plot.title = element_text(hjust = 0.5), plot.subtitle = element_text(hjust = 0.5) )
ggsave("../Results/Statsumm_At4.png",width = 6.6,height=5)
knitr::opts_chunk$set(echo = TRUE)
library("reshape2")
library(dplyr)
library(ggplot2)
library(tidyverse)
library(rmarkdown)
library(cowplot)
library(yaml)
library(knitr)
rawdata <- read.csv("../Input/20230405_RPMI_Atmut_screen_Plate1_csv.csv")
rawdata_day<-mutate(rawdata, Time = Time/86400)
reshaped <- melt(rawdata_day, id=c("Time", "Temp"),
variable.name="Well",
value.name="OD595")
summary(reshaped)
platemap <- read.csv("../Input/20230405_RPMI_Atmut_screen_Plate1_setup.csv")
head(platemap, n=50)
annotated <- inner_join(reshaped, platemap, by="Well")
ggplot(data=filter(annotated,Strain==""),
aes(x=Time, y=OD595, color=Strain, group = Well)) +
geom_line() +
facet_grid(Media ~ .) +
labs(x="Time (days)", y="Absorbance at 595 nm")
ggplot(data=filter(annotated,Well=="G12"),
aes(x=Time, y=OD595, color=Strain, group = Well)) +
geom_line() +
theme_bw()+
labs(x="Time (hrs)", y="Absorbance at 595 nm")
blank_OD_summary <- annotated %>%
filter(Strain=="") %>%
filter(Well != "A6") %>%
filter(Well != "A12") %>%
filter(Well != "H3") %>%
filter(Well != "F1") %>%
group_by(Media) %>%
summarise(OD_median=median(OD595),
OD_mean=mean(OD595),
OD_max=max(OD595),
OD_min=min(OD595))
print(blank_OD_summary)
normalisedOD <- annotated %>%
left_join(blank_OD_summary, by="Media") %>%
mutate(OD_corrected = OD595 - OD_median)
ggplot(data=normalisedOD %>%
filter(Strain != ""),
aes(x=Time, y=OD_corrected, color=Strain, group = Well)) +
geom_line() +
scale_y_continuous(limits=c(0,0.025),expand=c(0,0))+
facet_wrap(Strain ~ .)+
labs(x = "Time(Hrs)",
y = "Absorbance (595nm)") +
theme(text = element_text(size = 20))+
theme_bw()
ggplot(data=normalisedOD  %>%
dplyr::mutate(Strain = factor(Strain, levels = c("KN99 (WT)", "GAT201", "P2.7A1","P2.7A2","P2.7A3","P2.7A4","P2.7A5","P2.7A6","P2.7A7","P2.7A8","P2.7A9","P2.28A1","P2.28A2","P2.28A3","P2.28A4","P2.28A5","P2.28A6","P2.28A7","P2.28A8","P2.28A9" )))%>%
filter(Strain != ""),
aes(x=Time, y=OD_corrected, color=Strain)) +
#geom_line(aes(group = Well), size = 0.2, alpha = 0.2) +
stat_summary(fun = "median", geom = "line", size = 0.5) +
#scale_y_continuous(limits=c(0,0.5),expand=c(0,0), breaks = c(0, 0.05, 0.1)) +
labs(x = "Number of Days",
y = "Absorbance (595nm)",
title = "At mutant screen", subtitle = "Plate 1: RPMI at 37 degrees") +
theme_bw() +
theme(text = element_text(size = 15))+
theme(axis.title = element_text(size = 15))+
theme(axis.ticks.length = unit(0.3, "cm"))+
theme(title = element_text(size = 15))+
theme(panel.grid.minor = element_blank())+
guides(color=guide_legend(ncol=2))+
theme(legend.title = element_text(size = 15))+
theme(legend.background = element_rect(fill = "transparent", color=NA))+
theme(legend.key = element_rect(fill = "transparent", color=NA))+
theme (plot.background =  element_rect(fill = "transparent", color=NA),
panel.background = element_rect(fill = "transparent", color=NA),)+
theme(panel.border = element_rect(linetype = "solid", colour = "black", size = 2))+
theme(plot.title = element_text(hjust = 0.5), plot.subtitle = element_text(hjust = 0.5) )
ggsave("../Results/AllSummary_At1.png",width = 8,height=5)
ggplot(data=normalisedOD  %>%
dplyr::mutate(Strain = factor(Strain, levels = c("KN99 (WT)", "GAT201", "P2.7A1","P2.7A2","P2.7A3","P2.7A4","P2.7A5","P2.7A6","P2.7A7","P2.7A8","P2.7A9","P2.28A1","P2.28A2","P2.28A3","P2.28A4","P2.28A5","P2.28A6","P2.28A7","P2.28A8","P2.28A9" )))%>%
filter(Strain != ""),
aes(x=Time, y=OD_corrected, color=Strain)) +
geom_line(aes(group = Well), size = 0.2, alpha = 0.2) +
stat_summary(fun = "median", geom = "line", size = 0.5) +
#scale_y_continuous(limits=c(0,0.5),expand=c(0,0), breaks = c(0, 0.05, 0.1)) +
labs(x = "Number of Days",
y = "Absorbance (595nm)",
title = "At mutant screen", subtitle = "Plate 1: RPMI at 37 degrees") +
theme_bw() +
theme(text = element_text(size = 15))+
theme(axis.title = element_text(size = 15))+
theme(axis.ticks.length = unit(0.3, "cm"))+
theme(title = element_text(size = 15))+
theme(panel.grid.minor = element_blank())+
guides(color=guide_legend(ncol=2))+
theme(legend.title = element_text(size = 15))+
theme(legend.background = element_rect(fill = "transparent", color=NA))+
theme(legend.key = element_rect(fill = "transparent", color=NA))+
theme (plot.background =  element_rect(fill = "transparent", color=NA),
panel.background = element_rect(fill = "transparent", color=NA),)+
theme(panel.border = element_rect(linetype = "solid", colour = "black", size = 1))+
theme(plot.title = element_text(hjust = 0.5), plot.subtitle = element_text(hjust = 0.5))
ggplot
ggsave("../Results/Statsumm_At1.png",width = 8,height=5)
